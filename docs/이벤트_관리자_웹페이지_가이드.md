# 대중적인간 – 이벤트 생성·관리자 웹페이지 가이드

현재 프로젝트 구조를 기준으로 **이벤트 생성·관리자 웹페이지**에 필요한 요소와 구현 방법을 정리했습니다.

---

## 1. 현재 구조에서의 "이벤트" 의미

- **시나리오(Scenario)**: 퀴즈 내용 자체 (예: `wedding`, `blind-date`, `bbq`)  
  - `js/data.js`에 정의: 제목, 이모지, 배너, 질문/선택지/정답
- **이벤트(Event)**: 특정 **시나리오를 특정 시간대에 오픈**한 회차  
  - 예: "친구의 결혼식 – 2025년 2월 16일 12:00 ~ 15:00"  
  - 리워드(USDT), 플레이 제한시간, 필요 티켓, 참여 가능/준비중 상태 등이 이벤트 단위로 결정됨

관리자 페이지는 **이벤트(시나리오 + 일시·설정)** 를 생성·수정·삭제·조회하는 용도로 보면 됩니다.

---

## 2. 관리자 페이지에서 필요한 기능

| 구분 | 기능 | 설명 |
|------|------|------|
| **이벤트 목록** | 조회·필터 | 진행 중/예정/종료 이벤트 목록, 날짜·시나리오별 필터 |
| **이벤트 생성** | 새 이벤트 만들기 | 시나리오 선택, 시작/종료 일시, 리워드(USDT), 제한시간(분), 필요 티켓 등 입력 |
| **이벤트 수정** | 기존 이벤트 편집 | 일시·리워드·설정 변경 (진행 전/중에 따라 제한 가능) |
| **이벤트 삭제/비활성화** | 취소 또는 숨김 | 삭제 또는 "취소" 상태로 표시 |
| **시나리오 관리** (선택) | 문제/선택지 관리 | 새 시나리오 추가 또는 기존 시나리오(질문·정답) 수정 |

우선 **이벤트 CRUD(생성/조회/수정/삭제)** 에 집중하고, 시나리오 관리는 2단계로 두는 것을 권장합니다.

---

## 3. 필요한 기술 요소

### 3.1 백엔드(API)

현재 `js/api.js`의 `baseURL: 'https://api.popularhuman.com'` 은 있으나 대부분 주석 처리되어 있습니다. 관리자 페이지와 미니앱이 **같은 이벤트 데이터**를 쓰려면 백엔드가 필요합니다.

- **관리자 전용 API 예시**
  - `GET  /admin/events` – 이벤트 목록 (필터: 날짜, 상태)
  - `GET  /admin/events/:id` – 이벤트 상세
  - `POST /admin/events` – 이벤트 생성
  - `PUT  /admin/events/:id` – 이벤트 수정
  - `DELETE /admin/events/:id` – 이벤트 삭제 또는 비활성화
- **시나리오 목록**  
  - 미니앱에서 쓰는 시나리오 목록을 그대로 쓰면 됨: `GET /scenarios` 또는 현재처럼 정적 `scenarios` 목록을 관리자 쪽에서 참조

백엔드가 아직 없다면:
- Node.js(Express/Fastify), Python(Flask/FastAPI), Firebase/Firestore 등 중 하나로 **이벤트 CRUD API**를 먼저 만든 뒤, 관리자 웹은 이 API만 호출하도록 구현하면 됩니다.

### 3.2 이벤트 데이터 구조(예시)

관리자/백엔드에서 다룰 **이벤트** 스키마 예시는 아래와 같습니다.

```json
{
  "id": "evt_abc123",
  "scenarioId": "wedding",
  "title": "친구의 결혼식",
  "startAt": "2025-02-16T12:00:00Z",
  "endAt": "2025-02-16T15:00:00Z",
  "rewardUsdt": 50,
  "playTimeMinutes": 10,
  "requiredTickets": 1,
  "questionCount": 10,
  "status": "scheduled",
  "bannerImageUrl": "wedding_banner.png",
  "createdAt": "2025-02-10T00:00:00Z",
  "updatedAt": "2025-02-10T00:00:00Z"
}
```

- `status`: `draft` | `scheduled` | `live` | `ended` | `cancelled`  
- `scenarioId`: `data.js`의 키와 동일하게 두면 미니앱과 일치합니다.

### 3.3 관리자 인증

- 관리자 페이지는 **일반 사용자(LIFF 유저)에게 노출되면 안 됨**
- 구현 방법 예:
  - **백엔드 세션 + 로그인 폼**: ID/비밀번호 또는 이메일 로그인 후 세션 쿠키로 `/admin/*` API 호출
  - **간단 비밀번호**: 관리자 전용 URL + 단일 비밀번호로 진입 (프로토타입용)
  - **OAuth/Google 등**: 운영팀 계정만 허용

---

## 4. 관리자 웹페이지 구현 방법

### 4.1 배치 위치

- **같은 저장소 안**에 두는 경우:  
  - 예: `PopularHuman/admin/` 폴더에 관리자용 HTML/JS/CSS를 두고,  
  - `https://your-domain.com/admin/` 또는 `https://admin.popularhuman.com` 에 배포
- **별 도메인/서브도메인**으로 분리하면 보안·권한 관리하기 좋습니다.

### 4.2 기술 스택 선택

| 방식 | 장점 | 단점 |
|------|------|------|
| **순수 HTML + JS + CSS** | 현재 미니앱과 동일, 빌드 없음 | SPA처럼 만들면 코드가 길어짐 |
| **React / Vue / Svelte** | 폼·목록·상태 관리 편함, 재사용 컴포넌트 | 빌드 설정 필요 |
| **관리자 템플릿(Admin LTE 등)** | 로그인·테이블·폼 UI 빠르게 구성 | 디자인/의존성 맞춤 필요 |

현재 프로젝트가 **빌드 도구 없이 HTML + JS**이므로, **빠르게 시작**하려면 동일하게 **단일 HTML + JS**로 목록/등록/수정 화면을 만들고, 백엔드 API가 준비되면 `fetch`로 연동하는 방식이 자연스럽습니다.

### 4.3 구현 순서 제안

1. **백엔드**
   - 이벤트 테이블(또는 컬렉션) 설계
   - `GET/POST/PUT/DELETE /admin/events` 구현
   - 관리자 인증(세션 또는 토큰) 적용

2. **관리자 프론트**
   - **로그인 화면**: 관리자 비밀번호 또는 계정으로 로그인
   - **이벤트 목록 화면**: 테이블로 표시, 상태·날짜 필터, "추가" 버튼
   - **이벤트 생성 화면**: 시나리오 선택(드롭다운), 시작/종료 일시, 리워드, 제한시간, 필요 티켓 입력 후 `POST /admin/events`
   - **이벤트 수정 화면**: 기존 값 불러온 뒤 수정하여 `PUT /admin/events/:id`
   - **삭제/비활성화**: 목록에서 버튼으로 `DELETE` 호출

3. **미니앱 연동**
   - `API.getScenarios()` 또는 홈 화면용 **이벤트 목록 API**를 백엔드에서 제공 (예: `GET /events?date=2025-02-16`)
   - `index.html`의 "오늘의 시나리오" / "다음 시나리오 예고"를 이 API 응답으로 채우도록 `app.js`/`api.js` 수정

---

## 5. 관리자 페이지 UI 구성 예시

- **상단**: "대중적인간 관리자" 타이틀, 로그아웃
- **사이드/탭**: 이벤트 목록 | 이벤트 추가 (필요 시 나중에 "시나리오 관리" 추가)
- **이벤트 목록**
  - 컬럼: 이벤트명(시나리오), 시작일시, 종료일시, 리워드(USDT), 상태, [수정] [삭제]
  - 필터: 날짜 범위, 상태(예정/진행중/종료)
- **이벤트 추가/수정 폼**
  - 시나리오 선택 (wedding / blind-date / bbq 등)
  - 시작 일시, 종료 일시 (datetime-local 또는 날짜+시간 입력)
  - 리워드(USDT), 플레이 제한시간(분), 필요 티켓, 문제 수
  - [저장] [취소]

---

## 6. 정리

| 항목 | 내용 |
|------|------|
| **필요한 것** | 백엔드 이벤트 CRUD API, 관리자 인증, 이벤트 목록/생성/수정/삭제 화면 |
| **데이터** | 이벤트 = 시나리오 ID + 시작/종료 일시 + 리워드·제한시간·티켓 등 |
| **구현 순서** | ① 백엔드 API + 인증 → ② 관리자 로그인·목록·폼 → ③ 미니앱이 이벤트 API 사용하도록 연동 |
| **보안** | 관리자 페이지는 별 URL/도메인, 반드시 인증 후 접근 |

이 가이드를 기준으로 먼저 **백엔드 API**를 만들지, **관리자용 HTML/JS 초안**을 만들지 정한 뒤, 필요한 부분(예: API 스펙, 샘플 HTML)을 더 구체적으로 작성할 수 있습니다.
